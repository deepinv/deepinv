
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Trainer &#8212; deepinv 0.3.5 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=9112d68a" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=ba50482b"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=35a8b989"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-NSEKFKYSGR"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-NSEKFKYSGR');
            </script>
    <script>window.MathJax = {"tex": {"equationNumbers": {"autoNumber": "AMS", "useLabelIds": true}, "macros": {"forw": ["{A\\left({#1}\\right)}", 1], "noise": ["{N\\left({#1}\\right)}", 1], "inverse": ["{R\\left({#1}\\right)}", 1], "inversef": ["{R\\left({#1},{#2}\\right)}", 2], "inversename": "R", "reg": ["{g_\\sigma\\left({#1}\\right)}", 1], "regname": "g_\\sigma", "sensor": ["{\\eta\\left({#1}\\right)}", 1], "datafid": ["{f\\left({#1},{#2}\\right)}", 2], "datafidname": "f", "distance": ["{d\\left({#1},{#2}\\right)}", 2], "distancename": "d", "denoiser": ["{\\operatorname{D}_{{#2}}\\left({#1}\\right)}", 2], "denoisername": "\\operatorname{D}_{\\sigma}", "xset": "\\mathcal{X}", "yset": "\\mathcal{Y}", "group": "\\mathcal{G}", "metric": ["{d\\left({#1},{#2}\\right)}", 2], "loss": ["{\\mathcal\\left({#1}\\right)}", 1], "conj": ["{\\overline{#1}^{\\top}}", 1]}}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'api/stubs/deepinv.Trainer';</script>
    <link rel="canonical" href="https://deepinv.github.io/deepinv/api/stubs/deepinv.Trainer.html" />
    <link rel="icon" href="../../_static/logo.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="train" href="deepinv.train.html" />
    <link rel="prev" title="deepinv.training" href="../deepinv.training.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/deepinv_logolarge.png" class="logo__image only-light" alt="deepinv 0.3.5 documentation - Home"/>
    <img src="../../_static/logo_large_dark.png" class="logo__image only-dark pst-js-only" alt="deepinv 0.3.5 documentation - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../quickstart.html">
    Quickstart
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../auto_examples/index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../user_guide.html">
    User Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../API.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../finding_help.html">
    Finding Help
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../contributing.html">
    Contributing to DeepInverse
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../community.html">
    Community
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../quickstart.html">
    Quickstart
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../auto_examples/index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../user_guide.html">
    User Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../API.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../finding_help.html">
    Finding Help
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../contributing.html">
    Contributing to DeepInverse
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../community.html">
    Community
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../deepinv.datasets.html">deepinv.datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="deepinv.datasets.ImageDataset.html">ImageDataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.datasets.ImageFolder.html">ImageFolder</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.datasets.TensorDataset.html">TensorDataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.datasets.check_dataset.html">check_dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.datasets.HDF5Dataset.html">HDF5Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.datasets.generate_dataset.html">generate_dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.datasets.DIV2K.html">DIV2K</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.datasets.Urban100HR.html">Urban100HR</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.datasets.Set14HR.html">Set14HR</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.datasets.BSDS500.html">BSDS500</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.datasets.CBSD68.html">CBSD68</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.datasets.FastMRISliceDataset.html">FastMRISliceDataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.datasets.SimpleFastMRISliceDataset.html">SimpleFastMRISliceDataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.datasets.CMRxReconSliceDataset.html">CMRxReconSliceDataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.datasets.SKMTEASliceDataset.html">SKMTEASliceDataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.datasets.LidcIdriSliceDataset.html">LidcIdriSliceDataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.datasets.Flickr2kHR.html">Flickr2kHR</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.datasets.LsdirHR.html">LsdirHR</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.datasets.FMD.html">FMD</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.datasets.Kohler.html">Kohler</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.datasets.NBUDataset.html">NBUDataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.datasets.PatchDataset.html">PatchDataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.datasets.RandomPatchSampler.html">RandomPatchSampler</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.datasets.utils.PlaceholderDataset.html">PlaceholderDataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.datasets.utils.Rescale.html">Rescale</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.datasets.utils.ToComplex.html">ToComplex</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.datasets.utils.Crop.html">Crop</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.datasets.MRISliceTransform.html">MRISliceTransform</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../deepinv.loss.html">deepinv.loss</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.Loss.html">Loss</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.StackedPhysicsLoss.html">StackedPhysicsLoss</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.SupLoss.html">SupLoss</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.MCLoss.html">MCLoss</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.EILoss.html">EILoss</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.MOILoss.html">MOILoss</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.MOEILoss.html">MOEILoss</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.Neighbor2Neighbor.html">Neighbor2Neighbor</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.SplittingLoss.html">SplittingLoss</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.SureGaussianLoss.html">SureGaussianLoss</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.SurePoissonLoss.html">SurePoissonLoss</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.SurePGLoss.html">SurePGLoss</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.TVLoss.html">TVLoss</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.R2RLoss.html">R2RLoss</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.ScoreLoss.html">ScoreLoss</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.AugmentConsistencyLoss.html">AugmentConsistencyLoss</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.ReducedResolutionLoss.html">ReducedResolutionLoss</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.mri.WeightedSplittingLoss.html">WeightedSplittingLoss</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.mri.RobustSplittingLoss.html">RobustSplittingLoss</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.mri.Phase2PhaseLoss.html">Phase2PhaseLoss</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.mri.Artifact2ArtifactLoss.html">Artifact2ArtifactLoss</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.mri.ENSURELoss.html">ENSURELoss</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.adversarial.DiscriminatorMetric.html">DiscriminatorMetric</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.adversarial.GeneratorLoss.html">GeneratorLoss</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.adversarial.DiscriminatorLoss.html">DiscriminatorLoss</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.adversarial.SupAdversarialGeneratorLoss.html">SupAdversarialGeneratorLoss</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.adversarial.SupAdversarialDiscriminatorLoss.html">SupAdversarialDiscriminatorLoss</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.adversarial.UnsupAdversarialGeneratorLoss.html">UnsupAdversarialGeneratorLoss</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.adversarial.UnsupAdversarialDiscriminatorLoss.html">UnsupAdversarialDiscriminatorLoss</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.adversarial.UAIRGeneratorLoss.html">UAIRGeneratorLoss</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.JacobianSpectralNorm.html">JacobianSpectralNorm</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.FNEJacobianSpectralNorm.html">FNEJacobianSpectralNorm</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.BaseLossScheduler.html">BaseLossScheduler</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.RandomLossScheduler.html">RandomLossScheduler</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.InterleavedLossScheduler.html">InterleavedLossScheduler</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.InterleavedEpochLossScheduler.html">InterleavedEpochLossScheduler</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.StepLossScheduler.html">StepLossScheduler</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../deepinv.models.html">deepinv.models</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="deepinv.models.Denoiser.html">Denoiser</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.models.Reconstructor.html">Reconstructor</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.models.BM3D.html">BM3D</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.models.MedianFilter.html">MedianFilter</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.models.TVDenoiser.html">TVDenoiser</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.models.TGVDenoiser.html">TGVDenoiser</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.models.WaveletDenoiser.html">WaveletDenoiser</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.models.WaveletDictDenoiser.html">WaveletDictDenoiser</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.models.EPLLDenoiser.html">EPLLDenoiser</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.models.AutoEncoder.html">AutoEncoder</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.models.UNet.html">UNet</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.models.DnCNN.html">DnCNN</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.models.DRUNet.html">DRUNet</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.models.SCUNet.html">SCUNet</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.models.GSDRUNet.html">GSDRUNet</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.models.SwinIR.html">SwinIR</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.models.DiffUNet.html">DiffUNet</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.models.Restormer.html">Restormer</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.models.ICNN.html">ICNN</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.models.VarNet.html">VarNet</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.models.MoDL.html">MoDL</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.models.PanNet.html">PanNet</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.models.ADMUNet.html">ADMUNet</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.models.NCSNpp.html">NCSNpp</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.models.DScCP.html">DScCP</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.models.RAM.html">RAM</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.models.ArtifactRemoval.html">ArtifactRemoval</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.models.EquivariantDenoiser.html">EquivariantDenoiser</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.models.TimeAgnosticNet.html">TimeAgnosticNet</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.models.TimeAveragingNet.html">TimeAveragingNet</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.models.Client.html">Client</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.models.complex.to_complex_denoiser.html">to_complex_denoiser</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.models.DeepImagePrior.html">DeepImagePrior</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.models.ConvDecoder.html">ConvDecoder</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.models.PatchGANDiscriminator.html">PatchGANDiscriminator</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.models.ESRGANDiscriminator.html">ESRGANDiscriminator</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.models.DCGANGenerator.html">DCGANGenerator</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.models.DCGANDiscriminator.html">DCGANDiscriminator</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.models.CSGMGenerator.html">CSGMGenerator</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../deepinv.metric.html">deepinv.metric</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.metric.Metric.html">Metric</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.metric.MSE.html">MSE</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.metric.NMSE.html">NMSE</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.metric.MAE.html">MAE</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.metric.PSNR.html">PSNR</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.metric.SSIM.html">SSIM</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.metric.L1L2.html">L1L2</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.metric.LpNorm.html">LpNorm</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.metric.LPIPS.html">LPIPS</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.metric.SpectralAngleMapper.html">SpectralAngleMapper</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.metric.ERGAS.html">ERGAS</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.metric.HaarPSI.html">HaarPSI</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.metric.NIQE.html">NIQE</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.loss.metric.QNR.html">QNR</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../deepinv.optim.html">deepinv.optim</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.optim_builder.html">optim_builder</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.BaseOptim.html">BaseOptim</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.Potential.html">Potential</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.DataFidelity.html">DataFidelity</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.StackedPhysicsDataFidelity.html">StackedPhysicsDataFidelity</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.L1.html">L1</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.L2.html">L2</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.IndicatorL2.html">IndicatorL2</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.PoissonLikelihood.html">PoissonLikelihood</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.LogPoissonLikelihood.html">LogPoissonLikelihood</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.AmplitudeLoss.html">AmplitudeLoss</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.ZeroFidelity.html">ZeroFidelity</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.ItohFidelity.html">ItohFidelity</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.Prior.html">Prior</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.PnP.html">PnP</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.RED.html">RED</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.ScorePrior.html">ScorePrior</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.Tikhonov.html">Tikhonov</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.L1Prior.html">L1Prior</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.WaveletPrior.html">WaveletPrior</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.TVPrior.html">TVPrior</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.PatchPrior.html">PatchPrior</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.PatchNR.html">PatchNR</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.L12Prior.html">L12Prior</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.DPIR.html">DPIR</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.EPLL.html">EPLL</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.Bregman.html">Bregman</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.BregmanL2.html">BregmanL2</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.BurgEntropy.html">BurgEntropy</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.NegEntropy.html">NegEntropy</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.Bregman_ICNN.html">Bregman_ICNN</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.Distance.html">Distance</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.L2Distance.html">L2Distance</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.IndicatorL2Distance.html">IndicatorL2Distance</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.PoissonLikelihoodDistance.html">PoissonLikelihoodDistance</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.L1Distance.html">L1Distance</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.AmplitudeLossDistance.html">AmplitudeLossDistance</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.LogPoissonLikelihoodDistance.html">LogPoissonLikelihoodDistance</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.ZeroDistance.html">ZeroDistance</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.FixedPoint.html">FixedPoint</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.OptimIterator.html">OptimIterator</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.optim_iterators.fStep.html">fStep</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.optim_iterators.gStep.html">gStep</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.optim_iterators.GDIteration.html">GDIteration</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.optim_iterators.PGDIteration.html">PGDIteration</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.optim_iterators.FISTAIteration.html">FISTAIteration</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.optim_iterators.CPIteration.html">CPIteration</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.optim_iterators.ADMMIteration.html">ADMMIteration</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.optim_iterators.DRSIteration.html">DRSIteration</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.optim_iterators.HQSIteration.html">HQSIteration</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.optim_iterators.MDIteration.html">MDIteration</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.optim_iterators.SMIteration.html">SMIteration</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.utils.least_squares.html">least_squares</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.utils.least_squares_implicit_backward.html">least_squares_implicit_backward</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.utils.lsqr.html">lsqr</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.utils.bicgstab.html">bicgstab</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.utils.minres.html">minres</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.utils.conjugate_gradient.html">conjugate_gradient</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.utils.gradient_descent.html">gradient_descent</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.phase_retrieval.correct_global_phase.html">correct_global_phase</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.phase_retrieval.spectral_methods.html">spectral_methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.optim.utils.GaussianMixtureModel.html">GaussianMixtureModel</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../deepinv.physics.html">deepinv.physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.Physics.html">Physics</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.LinearPhysics.html">LinearPhysics</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.DecomposablePhysics.html">DecomposablePhysics</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.StackedPhysics.html">StackedPhysics</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.StackedLinearPhysics.html">StackedLinearPhysics</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.PhysicsMultiScaler.html">PhysicsMultiScaler</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.LinearPhysicsMultiScaler.html">LinearPhysicsMultiScaler</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.PhysicsCropper.html">PhysicsCropper</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.NoiseModel.html">NoiseModel</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.Denoising.html">Denoising</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.Inpainting.html">Inpainting</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.Decolorize.html">Decolorize</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.Demosaicing.html">Demosaicing</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.Blur.html">Blur</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.BlurFFT.html">BlurFFT</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.SpaceVaryingBlur.html">SpaceVaryingBlur</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.Downsampling.html">Downsampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.Upsampling.html">Upsampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.DownsamplingMatlab.html">DownsamplingMatlab</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.MRI.html">MRI</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.DynamicMRI.html">DynamicMRI</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.MultiCoilMRI.html">MultiCoilMRI</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.SequentialMRI.html">SequentialMRI</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.Tomography.html">Tomography</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.TomographyWithAstra.html">TomographyWithAstra</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.Pansharpen.html">Pansharpen</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.CompressiveSpectralImaging.html">CompressiveSpectralImaging</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.HyperSpectralUnmixing.html">HyperSpectralUnmixing</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.CompressedSensing.html">CompressedSensing</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.StructuredRandom.html">StructuredRandom</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.SinglePixelCamera.html">SinglePixelCamera</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.RadioInterferometry.html">RadioInterferometry</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.SinglePhotonLidar.html">SinglePhotonLidar</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.Haze.html">Haze</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.PhaseRetrieval.html">PhaseRetrieval</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.RandomPhaseRetrieval.html">RandomPhaseRetrieval</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.SpatialUnwrapping.html">SpatialUnwrapping</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.StructuredRandomPhaseRetrieval.html">StructuredRandomPhaseRetrieval</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.Ptychography.html">Ptychography</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.PtychographyLinearOperator.html">PtychographyLinearOperator</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.generator.PhysicsGenerator.html">PhysicsGenerator</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.generator.GeneratorMixture.html">GeneratorMixture</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.generator.BernoulliSplittingMaskGenerator.html">BernoulliSplittingMaskGenerator</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.generator.GaussianSplittingMaskGenerator.html">GaussianSplittingMaskGenerator</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.generator.MultiplicativeSplittingMaskGenerator.html">MultiplicativeSplittingMaskGenerator</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.generator.Phase2PhaseSplittingMaskGenerator.html">Phase2PhaseSplittingMaskGenerator</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.generator.Artifact2ArtifactSplittingMaskGenerator.html">Artifact2ArtifactSplittingMaskGenerator</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.generator.PSFGenerator.html">PSFGenerator</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.generator.MotionBlurGenerator.html">MotionBlurGenerator</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.generator.DownsamplingGenerator.html">DownsamplingGenerator</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.generator.DiffractionBlurGenerator.html">DiffractionBlurGenerator</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.generator.DiffractionBlurGenerator3D.html">DiffractionBlurGenerator3D</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.generator.ProductConvolutionBlurGenerator.html">ProductConvolutionBlurGenerator</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.generator.ConfocalBlurGenerator3D.html">ConfocalBlurGenerator3D</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.generator.BaseMaskGenerator.html">BaseMaskGenerator</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.generator.GaussianMaskGenerator.html">GaussianMaskGenerator</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.generator.RandomMaskGenerator.html">RandomMaskGenerator</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.generator.EquispacedMaskGenerator.html">EquispacedMaskGenerator</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.generator.PolyOrderMaskGenerator.html">PolyOrderMaskGenerator</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.blur.gaussian_blur.html">gaussian_blur</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.blur.bilinear_filter.html">bilinear_filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.blur.bicubic_filter.html">bicubic_filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.blur.sinc_filter.html">sinc_filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.phase_retrieval.build_probe.html">build_probe</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.phase_retrieval.generate_shifts.html">generate_shifts</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.NoiseModel.html">NoiseModel</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.ZeroNoise.html">ZeroNoise</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.GaussianNoise.html">GaussianNoise</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.LogPoissonNoise.html">LogPoissonNoise</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.PoissonNoise.html">PoissonNoise</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.PoissonGaussianNoise.html">PoissonGaussianNoise</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.UniformNoise.html">UniformNoise</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.UniformGaussianNoise.html">UniformGaussianNoise</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.GammaNoise.html">GammaNoise</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.SaltPepperNoise.html">SaltPepperNoise</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.FisherTippettNoise.html">FisherTippettNoise</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.RicianNoise.html">RicianNoise</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.generator.SigmaGenerator.html">SigmaGenerator</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.generator.GainGenerator.html">GainGenerator</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.adjoint_function.html">adjoint_function</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.stack.html">stack</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.functional.conv2d.html">conv2d</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.functional.conv_transpose2d.html">conv_transpose2d</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.functional.conv2d_fft.html">conv2d_fft</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.functional.conv_transpose2d_fft.html">conv_transpose2d_fft</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.functional.conv3d_fft.html">conv3d_fft</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.functional.conv_transpose3d_fft.html">conv_transpose3d_fft</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.functional.product_convolution2d.html">product_convolution2d</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.functional.multiplier.html">multiplier</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.functional.multiplier_adjoint.html">multiplier_adjoint</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.functional.histogramdd.html">histogramdd</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.functional.histogram.html">histogram</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.functional.dst1.html">dst1</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.functional.dct.html">dct</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.functional.idct.html">idct</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.functional.dct_2d.html">dct_2d</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.functional.idct_2d.html">idct_2d</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.functional.imresize_matlab.html">imresize_matlab</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.functional.Radon.html">Radon</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.functional.IRadon.html">IRadon</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.physics.functional.XrayTransform.html">XrayTransform</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../deepinv.sampling.html">deepinv.sampling</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="deepinv.sampling.BaseSDE.html">BaseSDE</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.sampling.DiffusionSDE.html">DiffusionSDE</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.sampling.VarianceExplodingDiffusion.html">VarianceExplodingDiffusion</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.sampling.VariancePreservingDiffusion.html">VariancePreservingDiffusion</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.sampling.PosteriorDiffusion.html">PosteriorDiffusion</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.sampling.NoisyDataFidelity.html">NoisyDataFidelity</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.sampling.DPSDataFidelity.html">DPSDataFidelity</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.sampling.BaseSDESolver.html">BaseSDESolver</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.sampling.EulerSolver.html">EulerSolver</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.sampling.HeunSolver.html">HeunSolver</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.sampling.SDEOutput.html">SDEOutput</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.sampling.DDRM.html">DDRM</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.sampling.DiffPIR.html">DiffPIR</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.sampling.DPS.html">DPS</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.sampling.DiffusionSampler.html">DiffusionSampler</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.sampling.sampling_builder.html">sampling_builder</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.sampling.BaseSampling.html">BaseSampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.sampling.ULA.html">ULA</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.sampling.SKRock.html">SKRock</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.sampling.SamplingIterator.html">SamplingIterator</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.sampling.SKRockIterator.html">SKRockIterator</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.sampling.ULAIterator.html">ULAIterator</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.sampling.DiffusionIterator.html">DiffusionIterator</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../deepinv.transform.html">deepinv.transform</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="deepinv.transform.Transform.html">Transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.transform.Rotate.html">Rotate</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.transform.Shift.html">Shift</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.transform.Scale.html">Scale</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.transform.Reflect.html">Reflect</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.transform.Identity.html">Identity</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.transform.Homography.html">Homography</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.transform.projective.Euclidean.html">Euclidean</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.transform.projective.Similarity.html">Similarity</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.transform.projective.Affine.html">Affine</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.transform.projective.PanTiltRotate.html">PanTiltRotate</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.transform.CPABDiffeomorphism.html">CPABDiffeomorphism</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.transform.ShiftTime.html">ShiftTime</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.transform.RandomNoise.html">RandomNoise</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.transform.RandomPhaseError.html">RandomPhaseError</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../deepinv.training.html">deepinv.training</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Trainer</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.train.html">train</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.test.html">test</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.training.AdversarialTrainer.html">AdversarialTrainer</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.training.AdversarialOptimizer.html">AdversarialOptimizer</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../deepinv.unfolded.html">deepinv.unfolded</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="deepinv.unfolded.unfolded_builder.html">unfolded_builder</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.unfolded.BaseUnfold.html">BaseUnfold</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.unfolded.DEQ_builder.html">DEQ_builder</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.unfolded.BaseDEQ.html">BaseDEQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.models.PDNet_PrimalBlock.html">PDNet_PrimalBlock</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.models.PDNet_DualBlock.html">PDNet_DualBlock</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../deepinv.utils.html">deepinv.utils</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="deepinv.utils.plot.html">plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.utils.plot_curves.html">plot_curves</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.utils.plot_parameters.html">plot_parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.utils.plot_inset.html">plot_inset</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.utils.plot_videos.html">plot_videos</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.utils.save_videos.html">save_videos</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.utils.plot_ortho3D.html">plot_ortho3D</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.utils.disable_tex.html">disable_tex</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.utils.enable_tex.html">enable_tex</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.utils.TensorList.html">deepinv.utils.TensorList</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.utils.zeros_like.html">zeros_like</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.utils.ones_like.html">ones_like</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.utils.randn_like.html">randn_like</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.utils.rand_like.html">rand_like</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.utils.AverageMeter.html">AverageMeter</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.utils.ProgressMeter.html">ProgressMeter</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.utils.get_timestamp.html">get_timestamp</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.utils.MRIMixin.html">MRIMixin</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.utils.TimeMixin.html">TimeMixin</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.utils.load_dicom.html">load_dicom</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.utils.load_nifti.html">load_nifti</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.utils.load_url.html">load_url</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.utils.load_np.html">load_np</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.utils.load_torch.html">load_torch</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.utils.load_mat.html">load_mat</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.utils.load_raster.html">load_raster</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.utils.load_ismrmd.html">load_ismrmd</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.utils.load_image.html">load_image</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.utils.load_url_image.html">load_url_image</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.utils.load_np_url.html">load_np_url</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.utils.load_torch_url.html">load_torch_url</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.utils.load_example.html">load_example</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.utils.download_example.html">download_example</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.utils.get_data_home.html">get_data_home</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.utils.get_image_url.html">get_image_url</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.utils.get_degradation_url.html">get_degradation_url</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.utils.load_dataset.html">load_dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.utils.load_degradation.html">load_degradation</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.utils.get_freer_gpu.html">get_freer_gpu</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepinv.utils.dirac_like.html">dirac_like</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../API.html" class="nav-link">API</a></li>
    
    
    <li class="breadcrumb-item"><a href="../deepinv.training.html" class="nav-link">deepinv.training</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Trainer</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="trainer">
<h1>Trainer<a class="headerlink" href="#trainer" title="Link to this heading">#</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="deepinv.Trainer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepinv.</span></span><span class="sig-name descname"><span class="pre">Trainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">physics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dataloader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">...</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/deepinv/training/trainer.html#Trainer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepinv.Trainer" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3.9/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Trainer class for training a reconstruction network.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>See the <a class="reference internal" href="../../user_guide/training/trainer.html#trainer"><span class="std std-ref">User Guide</span></a> for more details and for how to adapt the trainer to your needs.</p>
<p>See <a class="reference internal" href="../../auto_examples/models/demo_training.html#sphx-glr-auto-examples-models-demo-training-py"><span class="std std-ref">Training a reconstruction model</span></a> for a simple example of how to use the trainer.</p>
</div>
<p>Training can be done by calling the <a class="reference internal" href="#deepinv.Trainer.train" title="deepinv.Trainer.train"><code class="xref py py-func docutils literal notranslate"><span class="pre">deepinv.Trainer.train()</span></code></a> method, whereas
testing can be done by calling the <a class="reference internal" href="#deepinv.Trainer.test" title="deepinv.Trainer.test"><code class="xref py py-func docutils literal notranslate"><span class="pre">deepinv.Trainer.test()</span></code></a> method.</p>
<p><hr /></p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The training code can synchronize with MLOps tools like <a class="reference external" href="https://wandb.ai/site">Weights &amp; Biases</a> and <a class="reference external" href="https://mlflow.org">MLflow</a>
for logging and visualization by setting <code class="docutils literal notranslate"><span class="pre">wandb_vis=True</span></code> or <code class="docutils literal notranslate"><span class="pre">mlflow_vis=True</span></code>.</p>
</div>
<p>Parameters are described below, grouped into <strong>Basics</strong>, <strong>Optimization</strong>, <strong>Evaluation</strong>, <strong>Physics Generators</strong>,
<strong>Model Saving</strong>, <strong>Comparing with Pseudoinverse Baseline</strong>, <strong>Plotting</strong>, <strong>Verbose</strong> and <strong>Weights &amp; Biases</strong>.</p>
<dl class="field-list simple">
<dt class="field-odd">Basics<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<p>The <strong>dataloaders</strong> should return data in the correct format for DeepInverse: see <a class="reference internal" href="../../user_guide/training/datasets.html#datasets"><span class="std std-ref">datasets user guide</span></a> for
how to use predefined datasets, create datasets, or generate datasets. These will be checked automatically with <a class="reference internal" href="deepinv.datasets.check_dataset.html#deepinv.datasets.check_dataset" title="deepinv.datasets.check_dataset"><code class="xref py py-func docutils literal notranslate"><span class="pre">deepinv.datasets.check_dataset()</span></code></a>.</p>
<p>If the dataloaders do not return
measurements <code class="code docutils literal notranslate"><span class="pre">y</span></code>, then you should use the <code class="code docutils literal notranslate"><span class="pre">online_measurements=True</span></code> option which generates measurements in an online manner (optionally with parameters), running
under the hood <code class="code docutils literal notranslate"><span class="pre">y=physics(x)</span></code> or <code class="code docutils literal notranslate"><span class="pre">y=physics(x,</span> <span class="pre">**params)</span></code>. Otherwise if dataloaders do return measurements <code class="code docutils literal notranslate"><span class="pre">y</span></code>, set <code class="code docutils literal notranslate"><span class="pre">online_measurements=False</span></code> (default) otherwise
<code class="code docutils literal notranslate"><span class="pre">y</span></code> will be ignored and new measurements will be generated online.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If your dataloaders do not return <code class="code docutils literal notranslate"><span class="pre">y</span></code> but you do not want online measurements, use <a class="reference internal" href="deepinv.datasets.generate_dataset.html#deepinv.datasets.generate_dataset" title="deepinv.datasets.generate_dataset"><code class="xref py py-func docutils literal notranslate"><span class="pre">deepinv.datasets.generate_dataset()</span></code></a> to generate a dataset
of offline measurements from a dataset of <code class="code docutils literal notranslate"><span class="pre">x</span></code> and a <code class="code docutils literal notranslate"><span class="pre">physics</span></code>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="deepinv.models.Reconstructor.html#deepinv.models.Reconstructor" title="deepinv.models.Reconstructor"><em>deepinv.models.Reconstructor</em></a><em>, </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.9)"><em>torch.nn.Module</em></a>) – Reconstruction network, which can be <a class="reference internal" href="../../user_guide/reconstruction/introduction.html#reconstructors"><span class="std std-ref">any reconstruction network</span></a>.
or any other custom reconstruction network.</p></li>
<li><p><strong>physics</strong> (<a class="reference internal" href="deepinv.physics.Physics.html#deepinv.physics.Physics" title="deepinv.physics.Physics"><em>deepinv.physics.Physics</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>[</em><a class="reference internal" href="deepinv.physics.Physics.html#deepinv.physics.Physics" title="deepinv.physics.Physics"><em>deepinv.physics.Physics</em></a><em>]</em>) – <a class="reference internal" href="../../user_guide/physics/physics.html#physics-list"><span class="std std-ref">Forward operator(s)</span></a>.</p></li>
<li><p><strong>train_dataloader</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader" title="(in PyTorch v2.9)"><em>torch.utils.data.DataLoader</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader" title="(in PyTorch v2.9)"><em>torch.utils.data.DataLoader</em></a><em>]</em>) – Train data loader(s), see <a class="reference internal" href="../../user_guide/training/datasets.html#datasets"><span class="std std-ref">datasets user guide</span></a>
for how we expect data to be provided.</p></li>
<li><p><strong>online_measurements</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Generate new measurements <code class="code docutils literal notranslate"><span class="pre">y</span></code> in an online manner at each iteration by calling
<code class="code docutils literal notranslate"><span class="pre">y=physics(x)</span></code>. If <code class="code docutils literal notranslate"><span class="pre">False</span></code> (default), the measurements are loaded from the training dataset.</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.9)"><em>torch.device</em></a>) – Device on which to run the training (e.g., ‘cuda’ or ‘cpu’). Default is ‘cuda’ if available, otherwise ‘cpu’.</p></li>
</ul>
</dd>
</dl>
<p><hr /></p>
<dl class="field-list simple">
<dt class="field-odd">Optimization<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>optimizer</strong> (<em>None</em><em>, </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/optim.html#torch.optim.Optimizer" title="(in PyTorch v2.9)"><em>torch.optim.Optimizer</em></a>) – Torch optimizer for training the network. Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>epochs</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Number of training epochs.
Default is 100. The trainer will perform gradient steps equal to the <code class="code docutils literal notranslate"><span class="pre">min(epochs*n_batches,</span> <span class="pre">max_batch_steps)</span></code>.</p></li>
<li><p><strong>max_batch_steps</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Number of gradient steps per iteration.
Default is <code class="code docutils literal notranslate"><span class="pre">1e10</span></code>. The trainer will perform batch steps equal to the <code class="code docutils literal notranslate"><span class="pre">min(epochs*n_batches,</span> <span class="pre">max_batch_steps)</span></code>.</p></li>
<li><p><strong>scheduler</strong> (<em>None</em><em>, </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.optim.lr_scheduler.LRScheduler.html#torch.optim.lr_scheduler.LRScheduler" title="(in PyTorch v2.9)"><em>torch.optim.lr_scheduler.LRScheduler</em></a>) – Torch scheduler for changing the learning rate across iterations. Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>early_stop</strong> (<em>None</em><em>, </em><a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – If not <code class="docutils literal notranslate"><span class="pre">None</span></code>, the training stops when the first evaluation metric is not improving
after <code class="code docutils literal notranslate"><span class="pre">early_stop</span></code> passes over the eval dataset. Default is <code class="docutils literal notranslate"><span class="pre">None</span></code> (no early stopping).
The user can modify the strategy for saving the best model by overriding the <a class="reference internal" href="#deepinv.Trainer.stop_criterion" title="deepinv.Trainer.stop_criterion"><code class="xref py py-func docutils literal notranslate"><span class="pre">deepinv.Trainer.stop_criterion()</span></code></a> method.</p></li>
<li><p><strong>early_stop_on_losses</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Early stop using losses computed on the eval set instead of metrics. Default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>losses</strong> (<a class="reference internal" href="deepinv.loss.Loss.html#deepinv.loss.Loss" title="deepinv.loss.Loss"><em>deepinv.loss.Loss</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>[</em><a class="reference internal" href="deepinv.loss.Loss.html#deepinv.loss.Loss" title="deepinv.loss.Loss"><em>deepinv.loss.Loss</em></a><em>]</em>) – Loss or list of losses used for training the model.
Optionally wrap losses using a loss scheduler for more advanced training.
<a class="reference internal" href="../../user_guide/training/loss.html#loss"><span class="std std-ref">See the libraries’ training losses</span></a>.
Where relevant, the underlying metric should have <code class="docutils literal notranslate"><span class="pre">reduction=None</span></code> as we perform the averaging
using <a class="reference internal" href="deepinv.utils.AverageMeter.html#deepinv.utils.AverageMeter" title="deepinv.utils.AverageMeter"><code class="xref py py-class docutils literal notranslate"><span class="pre">deepinv.utils.AverageMeter</span></code></a> to deal with uneven batch sizes. Default is <a class="reference internal" href="deepinv.loss.SupLoss.html#deepinv.loss.SupLoss" title="deepinv.loss.SupLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">supervised</span> <span class="pre">loss</span></code></a>.</p></li>
<li><p><strong>grad_clip</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Gradient clipping value for the optimizer. If None, no gradient clipping is performed. Default is None.</p></li>
<li><p><strong>optimizer_step_multi_dataset</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the optimizer step is performed once on all datasets. If <code class="docutils literal notranslate"><span class="pre">False</span></code>, the optimizer step is performed on each dataset separately.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The losses and evaluation metrics can be chosen from <a class="reference internal" href="../../user_guide/training/loss.html#loss"><span class="std std-ref">our training losses</span></a> or <a class="reference internal" href="../../user_guide/training/metric.html#metric"><span class="std std-ref">our metrics</span></a></p>
<p>Custom losses can be used, as long as it takes as input <code class="docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">x_net,</span> <span class="pre">y,</span> <span class="pre">physics,</span> <span class="pre">model)</span></code>
and returns a tensor of length <code class="code docutils literal notranslate"><span class="pre">batch_size</span></code> (i.e. <code class="code docutils literal notranslate"><span class="pre">reduction=None</span></code> in the underlying metric, as we perform averaging to deal with uneven batch sizes),
where <code class="docutils literal notranslate"><span class="pre">x</span></code> is the ground truth, <code class="docutils literal notranslate"><span class="pre">x_net</span></code> is the network reconstruction <span class="math notranslate nohighlight">\(\inversef{y}{A}\)</span>,
<code class="docutils literal notranslate"><span class="pre">y</span></code> is the measurement vector, <code class="docutils literal notranslate"><span class="pre">physics</span></code> is the forward operator
and <code class="docutils literal notranslate"><span class="pre">model</span></code> is the reconstruction network. Note that not all inputs need to be used by the loss,
e.g., self-supervised losses will not make use of <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
<p>Custom metrics can also be used in the exact same way as custom losses.</p>
</div>
<p><hr /></p>
<dl class="field-list simple">
<dt class="field-odd">Evaluation<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p><strong>Supervised evaluation</strong>: If ground-truth data is available for validation, use any
<a class="reference internal" href="../../user_guide/training/metric.html#full-reference-metrics"><span class="std std-ref">full reference metric</span></a>, e.g. <a class="reference internal" href="deepinv.loss.metric.PSNR.html#deepinv.loss.metric.PSNR" title="deepinv.loss.metric.PSNR"><code class="xref py py-class docutils literal notranslate"><span class="pre">PSNR</span></code></a>.</p></li>
<li><p><strong>Self-supervised evaluation</strong>: If no ground-truth data is available for validation, it is
still possible to validate using:</p>
<ul>
<li><ol class="lowerroman simple">
<li><p><a class="reference internal" href="../../user_guide/training/metric.html#no-reference-metrics"><span class="std std-ref">no reference metrics</span></a>, e.g. <a class="reference internal" href="deepinv.loss.metric.NIQE.html#deepinv.loss.metric.NIQE" title="deepinv.loss.metric.NIQE"><code class="xref py py-class docutils literal notranslate"><span class="pre">NIQE</span></code></a></p></li>
</ol>
</li>
<li><p>ii) <a class="reference internal" href="../../user_guide/training/loss.html#self-supervised-losses"><span class="std std-ref">self-supervised losses</span></a> with
<code class="docutils literal notranslate"><span class="pre">compute_eval_losses=True</span></code> and <code class="docutils literal notranslate"><span class="pre">metrics=None</span></code>. If self-supervised losses
are used, we recommend setting <code class="docutils literal notranslate"><span class="pre">compute_train_metrics=False</span></code> to avoid computing
metrics in <code class="docutils literal notranslate"><span class="pre">model.train()</span></code> mode. This is required by many self-supervised losses,
such as <a class="reference internal" href="deepinv.loss.SplittingLoss.html#deepinv.loss.SplittingLoss" title="deepinv.loss.SplittingLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">SplittingLoss</span></code></a> or
<a class="reference internal" href="deepinv.loss.R2RLoss.html#deepinv.loss.R2RLoss" title="deepinv.loss.R2RLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">R2RLoss</span></code></a>, which behave differently in
<code class="docutils literal notranslate"><span class="pre">model.train()</span></code> and <code class="docutils literal notranslate"><span class="pre">model.eval()</span></code> modes.</p></li>
</ul>
</li>
</ul>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eval_dataloader</strong> (<em>None</em><em>, </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader" title="(in PyTorch v2.9)"><em>torch.utils.data.DataLoader</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader" title="(in PyTorch v2.9)"><em>torch.utils.data.DataLoader</em></a><em>]</em>) – Evaluation data loader(s),
see <a class="reference internal" href="../../user_guide/training/datasets.html#datasets"><span class="std std-ref">datasets user guide</span></a> for how we expect data to be provided.</p></li>
<li><p><strong>metrics</strong> (<a class="reference internal" href="deepinv.loss.metric.Metric.html#deepinv.loss.metric.Metric" title="deepinv.loss.metric.Metric"><em>Metric</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>[</em><a class="reference internal" href="deepinv.loss.metric.Metric.html#deepinv.loss.metric.Metric" title="deepinv.loss.metric.Metric"><em>Metric</em></a><em>]</em><em>, </em><em>None</em>) – Metric or list of metrics used for evaluating the model.
They should have <code class="docutils literal notranslate"><span class="pre">reduction=None</span></code> as we perform the averaging using <a class="reference internal" href="deepinv.utils.AverageMeter.html#deepinv.utils.AverageMeter" title="deepinv.utils.AverageMeter"><code class="xref py py-class docutils literal notranslate"><span class="pre">deepinv.utils.AverageMeter</span></code></a> to deal with uneven batch sizes.
<a class="reference internal" href="../../user_guide/training/metric.html#metric"><span class="std std-ref">See the libraries’ evaluation metrics</span></a>. Default is <a class="reference internal" href="deepinv.loss.metric.PSNR.html#deepinv.loss.metric.PSNR" title="deepinv.loss.metric.PSNR"><code class="xref py py-class docutils literal notranslate"><span class="pre">PSNR</span></code></a>.</p></li>
<li><p><strong>compute_train_metrics</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – <p>If <code class="code docutils literal notranslate"><span class="pre">False</span></code>, do not compute metrics during training on train set.
If <code class="code docutils literal notranslate"><span class="pre">True</span></code> (default), during training all metrics are computed on the training dataloader.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If <code class="code docutils literal notranslate"><span class="pre">compute_train_metrics=True</span></code> the metrics are computed using the model prediction during training (i.e., in <code class="code docutils literal notranslate"><span class="pre">model.train()</span></code> mode) to avoid an additional
forward pass. This can lead to metrics that are different at test time when the model is in <code class="code docutils literal notranslate"><span class="pre">model.eval()</span></code> mode,
and/or produce errors if the network does not provide the same output shapes under train and eval modes (e.g., which is the case of <a class="reference internal" href="deepinv.loss.ReducedResolutionLoss.html#deepinv.loss.ReducedResolutionLoss" title="deepinv.loss.ReducedResolutionLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">some</span> <span class="pre">self-supervised</span> <span class="pre">losses</span></code></a>).</p>
</div>
</p></li>
<li><p><strong>eval_interval</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Number of epochs (or train iters, if <code class="docutils literal notranslate"><span class="pre">log_train_batch=True</span></code>) between each evaluation of
the model on the evaluation set. Default is <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p></li>
<li><p><strong>log_train_batch</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, log train batch and eval-set metrics and losses for each train batch during training.
This is useful for visualising train progress inside an epoch, not just over epochs.
If <code class="docutils literal notranslate"><span class="pre">False</span></code> (default), log average over dataset per epoch (standard training).</p></li>
<li><p><strong>compute_eval_losses</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the losses are computed during evaluation. Default is <code class="docutils literal notranslate"><span class="pre">False</span></code>. This is useful
when using self-supervised losses for evaluation and early-stopping or to make sure that the model is performing
similarly on losses on the train and eval sets.</p></li>
</ul>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If a validation dataloader <code class="code docutils literal notranslate"><span class="pre">eval_dataloader</span></code> is provided, the trainer will also <strong>save the best model</strong> according to the
first metric in the list, using the following format:
<code class="docutils literal notranslate"><span class="pre">save_path/yyyy-mm-dd_hh-mm-ss/ckp_best.pth.tar</span></code>. The user can modify the strategy for saving the best model
by overriding the <a class="reference internal" href="#deepinv.Trainer.save_best_model" title="deepinv.Trainer.save_best_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">deepinv.Trainer.save_best_model()</span></code></a> method.
The best model can be also loaded using the <a class="reference internal" href="#deepinv.Trainer.load_best_model" title="deepinv.Trainer.load_best_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">deepinv.Trainer.load_best_model()</span></code></a> method.</p>
</div>
<p><hr /></p>
<dl class="field-list simple">
<dt class="field-odd">Physics Generators<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>physics_generator</strong> (<em>None</em><em>, </em><a class="reference internal" href="deepinv.physics.generator.PhysicsGenerator.html#deepinv.physics.generator.PhysicsGenerator" title="deepinv.physics.generator.PhysicsGenerator"><em>deepinv.physics.generator.PhysicsGenerator</em></a>) – Optional <a class="reference internal" href="../../user_guide/physics/intro.html#physics-generators"><span class="std std-ref">physics generator</span></a> for generating
the physics operators. If not <code class="code docutils literal notranslate"><span class="pre">None</span></code>, the physics operators are randomly sampled at each iteration using the generator.
Should be used in conjunction with <code class="docutils literal notranslate"><span class="pre">online_measurements=True</span></code>, no effect when <code class="docutils literal notranslate"><span class="pre">online_measurements=False</span></code>. Also see <code class="docutils literal notranslate"><span class="pre">loop_random_online_physics</span></code>. Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>loop_random_online_physics</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – if <code class="code docutils literal notranslate"><span class="pre">True</span></code>, resets the physics generator <strong>and</strong> noise model back to its initial state at the beginning of each epoch,
so that the same measurements are generated each epoch. Requires <code class="code docutils literal notranslate"><span class="pre">shuffle=False</span></code> in dataloaders. If <code class="code docutils literal notranslate"><span class="pre">False</span></code>, generates new physics every epoch.
Used in conjunction with <code class="docutils literal notranslate"><span class="pre">online_measurements=True</span></code> and <code class="code docutils literal notranslate"><span class="pre">physics_generator</span></code> or noise model in <code class="code docutils literal notranslate"><span class="pre">physics</span></code>, no effect when <code class="docutils literal notranslate"><span class="pre">online_measurements=False</span></code>. Default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If the physics changes at each iteration for online measurements (e.g. if <code class="code docutils literal notranslate"><span class="pre">physics_generator</span></code> is used to generate random physics operators or noise model is used),
the generated measurements will randomly vary each epoch.
If this is not desired (i.e. you want the same online measurements each epoch), set <code class="docutils literal notranslate"><span class="pre">loop_random_online_physics=True</span></code>.
This resets the physics generator and noise model’s random generators every epoch.</p>
<p><strong>Caveat</strong>: this requires <code class="docutils literal notranslate"><span class="pre">shuffle=False</span></code> in your dataloaders.</p>
<p>An alternative, safer solution is to generate and save params offline using <a class="reference internal" href="deepinv.datasets.generate_dataset.html#deepinv.datasets.generate_dataset" title="deepinv.datasets.generate_dataset"><code class="xref py py-func docutils literal notranslate"><span class="pre">deepinv.datasets.generate_dataset()</span></code></a>.
The params dict will then be automatically updated every time data is loaded.</p>
</div>
<p><hr /></p>
<dl class="field-list simple">
<dt class="field-odd">Model Saving<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>save_path</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Directory in which to save the trained model. Default is <code class="docutils literal notranslate"><span class="pre">&quot;.&quot;</span></code> (current folder).</p></li>
<li><p><strong>ckp_interval</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The model is saved every <code class="docutils literal notranslate"><span class="pre">ckp_interval</span></code> epochs. Default is <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p></li>
<li><p><strong>ckpt_pretrained</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – path of the pretrained checkpoint. If <code class="code docutils literal notranslate"><span class="pre">None</span></code> (default), no pretrained checkpoint is loaded.</p></li>
</ul>
</dd>
</dl>
<p>Training details are saved every <code class="docutils literal notranslate"><span class="pre">ckp_interval</span></code> epochs in the following format</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">save_path</span><span class="o">/</span><span class="n">yyyy</span><span class="o">-</span><span class="n">mm</span><span class="o">-</span><span class="n">dd_hh</span><span class="o">-</span><span class="n">mm</span><span class="o">-</span><span class="n">ss</span><span class="o">/</span><span class="n">ckp_</span><span class="p">{</span><span class="n">epoch</span><span class="p">}</span><span class="o">.</span><span class="n">pth</span><span class="o">.</span><span class="n">tar</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">.pth.tar</span></code> file contains a dictionary with the keys:</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">epoch</span></code>: current epoch number when saved</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">state_dict</span></code>: model parameters state dictionary</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">loss</span></code>: loss history on train set</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">train_metrics</span></code>: metric history on train set</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">eval_loss</span></code>: loss history on eval set</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">eval_metrics</span></code>: metric history on eval set</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">optimizer</span></code>: optimizer state dictionary, or <code class="docutils literal notranslate"><span class="pre">None</span></code> if not used</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">scheduler</span></code>: learning rate scheduler state dictionary, or <code class="docutils literal notranslate"><span class="pre">None</span></code> if not used</p></li>
</ul>
<p><hr /></p>
<dl class="field-list simple">
<dt class="field-odd">Comparison with Pseudoinverse Baseline<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>compare_no_learning</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the no learning method is compared to the network reconstruction. Default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>no_learning_method</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Reconstruction method used for the no learning comparison. Options are <code class="docutils literal notranslate"><span class="pre">'A_dagger'</span></code>, <code class="docutils literal notranslate"><span class="pre">'A_adjoint'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'prox_l2'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'y'</span></code>. Default is <code class="docutils literal notranslate"><span class="pre">'A_dagger'</span></code>. The user can also provide a custom method by overriding the
<a class="reference internal" href="#deepinv.Trainer.no_learning_inference" title="deepinv.Trainer.no_learning_inference"><code class="xref py py-func docutils literal notranslate"><span class="pre">no_learning_inference</span></code></a> method. Default is <code class="docutils literal notranslate"><span class="pre">'A_adjoint'</span></code>.</p></li>
</ul>
</dd>
</dl>
<p><hr /></p>
<dl class="field-list simple">
<dt class="field-odd">Plotting<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>plot_images</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Plots reconstructions every <code class="docutils literal notranslate"><span class="pre">ckp_interval</span></code> epochs. Default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>plot_measurements</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Plot the measurements y, default is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>plot_convergence_metrics</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Plot convergence metrics for model, default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>rescale_mode</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Rescale mode for plotting images. Default is <code class="docutils literal notranslate"><span class="pre">'clip'</span></code>.</p></li>
</ul>
</dd>
</dl>
<p><hr /></p>
<dl class="field-list simple">
<dt class="field-odd">Verbose<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Output training progress information in the console. Default is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>verbose_individual_losses</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the value of individual losses are printed during training.
Otherwise, only the total loss is printed. Default is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>show_progress_bar</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Show a progress bar during training. Default is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>freq_update_progress_bar</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – progress bar postfix update frequency (measured in iterations). Defaults to 1.
Increasing this may speed up training.</p></li>
<li><p><strong>check_grad</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Compute and print the gradient norm at each iteration. Default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
</dl>
<p><hr /></p>
<dl class="field-list simple">
<dt class="field-odd">Weights &amp; Biases<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>wandb_vis</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Logs data onto Weights &amp; Biases, see <a class="reference external" href="https://wandb.ai/">https://wandb.ai/</a> for more details. Default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>wandb_setup</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – Dictionary with the setup for wandb, see <a class="reference external" href="https://docs.wandb.ai/quickstart">https://docs.wandb.ai/quickstart</a> for more details. Default is <code class="docutils literal notranslate"><span class="pre">{}</span></code>.</p></li>
<li><p><strong>plot_interval</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Frequency of plotting images to MLOps tools (wandb or MLflow) during evaluation (at the end of each epoch).
If <code class="docutils literal notranslate"><span class="pre">1</span></code>, plots at each epoch. Default is <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p></li>
<li><p><strong>freq_plot</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – deprecated. Use <code class="docutils literal notranslate"><span class="pre">plot_interval</span></code></p></li>
</ul>
</dd>
</dl>
<p><hr /></p>
<dl class="field-list simple">
<dt class="field-odd">MLflow<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>mlflow_vis</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Logs data onto MLflow, see <a class="reference external" href="https://mlflow.org/">https://mlflow.org/</a> for more details. Default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>mlflow_setup</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – Dictionary with the setup for mlflow, see <a class="reference external" href="https://www.mlflow.org/docs/latest/python_api/mlflow.html#mlflow.start_run">https://www.mlflow.org/docs/latest/python_api/mlflow.html#mlflow.start_run</a> for more details. Default is <code class="docutils literal notranslate"><span class="pre">{}</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="deepinv.Trainer.check_clip_grad">
<span class="sig-name descname"><span class="pre">check_clip_grad</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/deepinv/training/trainer.html#Trainer.check_clip_grad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepinv.Trainer.check_clip_grad" title="Link to this definition">#</a></dt>
<dd><p>Check the gradient norm and perform gradient clipping if necessary.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepinv.Trainer.compute_loss">
<span class="sig-name descname"><span class="pre">compute_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">physics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/deepinv/training/trainer.html#Trainer.compute_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepinv.Trainer.compute_loss" title="Link to this definition">#</a></dt>
<dd><p>Compute the loss and perform the backward pass.</p>
<p>It evaluates the reconstruction network, computes the losses, and performs the backward pass.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>physics</strong> (<a class="reference internal" href="deepinv.physics.Physics.html#deepinv.physics.Physics" title="deepinv.physics.Physics"><em>deepinv.physics.Physics</em></a>) – Current physics operator.</p></li>
<li><p><strong>x</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Ground truth.</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Measurement.</p></li>
<li><p><strong>train</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the model is trained, otherwise it is evaluated.</p></li>
<li><p><strong>epoch</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – current epoch.</p></li>
<li><p><strong>step</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Whether to perform an optimization step when computing the loss.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(tuple) The network reconstruction x_net (for plotting and computing metrics) and
the logs (for printing the training progress).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepinv.Trainer.compute_metrics">
<span class="sig-name descname"><span class="pre">compute_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_net</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">physics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/deepinv/training/trainer.html#Trainer.compute_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepinv.Trainer.compute_metrics" title="Link to this definition">#</a></dt>
<dd><p>Compute the metrics.</p>
<p>It computes the metrics over the batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Ground truth.</p></li>
<li><p><strong>x_net</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Network reconstruction.</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Measurement.</p></li>
<li><p><strong>physics</strong> (<a class="reference internal" href="deepinv.physics.Physics.html#deepinv.physics.Physics" title="deepinv.physics.Physics"><em>deepinv.physics.Physics</em></a>) – Current physics operator.</p></li>
<li><p><strong>logs</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – Dictionary containing the logs for printing the training progress.</p></li>
<li><p><strong>train</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the model is trained, otherwise it is evaluated.</p></li>
<li><p><strong>epoch</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – current epoch.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The reconstructed signal during eval (if <code class="code docutils literal notranslate"><span class="pre">x_net=None</span></code>) and the logs with the metrics</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepinv.Trainer.get_samples">
<span class="sig-name descname"><span class="pre">get_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterators</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/deepinv/training/trainer.html#Trainer.get_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepinv.Trainer.get_samples" title="Link to this definition">#</a></dt>
<dd><p>Get the samples.</p>
<p>This function returns a dictionary containing necessary data for the model inference. It needs to contain
the measurement, the ground truth, and the current physics operator, but can also contain additional data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iterators</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – List of dataloader iterators.</p></li>
<li><p><strong>g</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Current dataloader index.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the tuple returned by the get_samples_online or get_samples_offline function.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepinv.Trainer.get_samples_offline">
<span class="sig-name descname"><span class="pre">get_samples_offline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterators</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/deepinv/training/trainer.html#Trainer.get_samples_offline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepinv.Trainer.get_samples_offline" title="Link to this definition">#</a></dt>
<dd><p>Get the samples for the offline measurements.</p>
<p>In this setting, samples have been generated offline and are loaded from the dataloader.
This function returns a tuple containing necessary data for the model inference. It needs to contain
the measurement, the ground truth, and the current physics operator, but can also contain additional data
(you can override this function to add custom data).</p>
<p>If the dataloader returns 3-tuples, this is assumed to be <code class="docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y,</span> <span class="pre">params)</span></code> where
<code class="docutils literal notranslate"><span class="pre">params</span></code> is a dict of physics generator params. These params are then used to update
the physics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iterators</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – List of dataloader iterators.</p></li>
<li><p><strong>g</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Current dataloader index.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a dictionary containing at least: the ground truth, the measurement, and the current physics operator.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepinv.Trainer.get_samples_online">
<span class="sig-name descname"><span class="pre">get_samples_online</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterators</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/deepinv/training/trainer.html#Trainer.get_samples_online"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepinv.Trainer.get_samples_online" title="Link to this definition">#</a></dt>
<dd><p>Get the samples for the online measurements.</p>
<p>In this setting, a new sample is generated at each iteration by calling the physics operator.
This function returns a dictionary containing necessary data for the model inference. It needs to contain
the measurement, the ground truth, and the current physics operator, but can also contain additional data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iterators</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – List of dataloader iterators.</p></li>
<li><p><strong>g</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Current dataloader index.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a tuple containing at least: the ground truth, the measurement, and the current physics operator.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepinv.Trainer.load_best_model">
<span class="sig-name descname"><span class="pre">load_best_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/deepinv/training/trainer.html#Trainer.load_best_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepinv.Trainer.load_best_model" title="Link to this definition">#</a></dt>
<dd><p>Load the best model.</p>
<p>It loads the model from the checkpoint saved during training.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepinv.Trainer.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ckpt_pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/deepinv/training/trainer.html#Trainer.load_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepinv.Trainer.load_model" title="Link to this definition">#</a></dt>
<dd><p>Load model from checkpoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ckpt_pretrained</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – checkpoint filename. If <code class="code docutils literal notranslate"><span class="pre">None</span></code>, use checkpoint passed to class init.
If not <code class="code docutils literal notranslate"><span class="pre">None</span></code>, override checkpoint passed to class.</p></li>
<li><p><strong>strict</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – strict load weights to model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>if checkpoint loaded, return checkpoint dict, else return <code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepinv.Trainer.log_metrics_mlops">
<span class="sig-name descname"><span class="pre">log_metrics_mlops</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/deepinv/training/trainer.html#Trainer.log_metrics_mlops"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepinv.Trainer.log_metrics_mlops" title="Link to this definition">#</a></dt>
<dd><p>Log the metrics to MLOps tools including wandb and MLflow.</p>
<p>It logs the metrics to wandb and MLflow.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logs</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – Dictionary containing the metrics to log.</p></li>
<li><p><strong>step</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Current step to log. If <code class="docutils literal notranslate"><span class="pre">Trainer.log_train_batch=True</span></code>, this is the batch iteration, if <code class="docutils literal notranslate"><span class="pre">False</span></code> (default), this is the epoch.</p></li>
<li><p><strong>train</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the model is trained, otherwise it is evaluated.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepinv.Trainer.log_metrics_wandb">
<span class="sig-name descname"><span class="pre">log_metrics_wandb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/deepinv/training/trainer.html#Trainer.log_metrics_wandb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepinv.Trainer.log_metrics_wandb" title="Link to this definition">#</a></dt>
<dd><p>This method is deprecated and will be removed in a future release. Instead, use <a class="reference internal" href="#deepinv.Trainer.log_metrics_mlops" title="deepinv.Trainer.log_metrics_mlops"><code class="xref py py-func docutils literal notranslate"><span class="pre">log_metrics_mlops()</span></code></a>.</p>
<dl class="field-list simple">
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepinv.Trainer.model_inference">
<span class="sig-name descname"><span class="pre">model_inference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">physics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/deepinv/training/trainer.html#Trainer.model_inference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepinv.Trainer.model_inference" title="Link to this definition">#</a></dt>
<dd><p>Perform the model inference.</p>
<p>It returns the network reconstruction given the samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Measurement.</p></li>
<li><p><strong>physics</strong> (<a class="reference internal" href="deepinv.physics.Physics.html#deepinv.physics.Physics" title="deepinv.physics.Physics"><em>deepinv.physics.Physics</em></a>) – Current physics operator.</p></li>
<li><p><strong>x</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Optional ground truth, used for computing convergence metrics.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The network reconstruction.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepinv.Trainer.no_learning_inference">
<span class="sig-name descname"><span class="pre">no_learning_inference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">physics</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/deepinv/training/trainer.html#Trainer.no_learning_inference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepinv.Trainer.no_learning_inference" title="Link to this definition">#</a></dt>
<dd><p>Perform the no learning inference.</p>
<p>By default it returns the (linear) pseudo-inverse reconstruction given the measurement.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Measurement.</p></li>
<li><p><strong>physics</strong> (<a class="reference internal" href="deepinv.physics.Physics.html#deepinv.physics.Physics" title="deepinv.physics.Physics"><em>deepinv.physics.Physics</em></a>) – Current physics operator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Reconstructed image.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepinv.Trainer.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">physics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_net</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/deepinv/training/trainer.html#Trainer.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepinv.Trainer.plot" title="Link to this definition">#</a></dt>
<dd><p>Plot and optinally save the reconstructions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epoch</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Current epoch.</p></li>
<li><p><strong>physics</strong> (<a class="reference internal" href="deepinv.physics.Physics.html#deepinv.physics.Physics" title="deepinv.physics.Physics"><em>deepinv.physics.Physics</em></a>) – Current physics operator.</p></li>
<li><p><strong>x</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Ground truth.</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Measurement.</p></li>
<li><p><strong>x_net</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.9)"><em>torch.Tensor</em></a>) – Network reconstruction.</p></li>
<li><p><strong>train</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the model is trained, otherwise it is evaluated.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepinv.Trainer.reset_metrics">
<span class="sig-name descname"><span class="pre">reset_metrics</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/deepinv/training/trainer.html#Trainer.reset_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepinv.Trainer.reset_metrics" title="Link to this definition">#</a></dt>
<dd><p>Reset the metrics.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepinv.Trainer.save_best_model">
<span class="sig-name descname"><span class="pre">save_best_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_ite</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/deepinv/training/trainer.html#Trainer.save_best_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepinv.Trainer.save_best_model" title="Link to this definition">#</a></dt>
<dd><p>Save the best model using validation metrics.</p>
<p>By default, uses validation based on first metric. If no metric is provided (e.g. in self-supervised learning),
uses the first loss on the eval dataset instead (requires having <code class="code docutils literal notranslate"><span class="pre">compute_eval_losses=True</span></code>).</p>
<p>Override this method to provide custom criterion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epoch</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Current epoch.</p></li>
<li><p><strong>train_ite</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Current training batch iteration, equal to (current epoch <span class="math notranslate nohighlight">\(\times\)</span>
number of batches) + current batch within epoch</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepinv.Trainer.save_model">
<span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/deepinv/training/trainer.html#Trainer.save_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepinv.Trainer.save_model" title="Link to this definition">#</a></dt>
<dd><p>Save the model.</p>
<p>It saves the model every <code class="docutils literal notranslate"><span class="pre">ckp_interval</span></code> epochs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epoch</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Current epoch.</p></li>
<li><p><strong>eval_metrics</strong> (<em>None</em><em>, </em><a class="reference external" href="https://docs.python.org/3.9/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Evaluation metrics across epochs.</p></li>
<li><p><strong>state</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – custom objects to save with model</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepinv.Trainer.setup_train">
<span class="sig-name descname"><span class="pre">setup_train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/deepinv/training/trainer.html#Trainer.setup_train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepinv.Trainer.setup_train" title="Link to this definition">#</a></dt>
<dd><p>Set up the training process.</p>
<p>It initializes the wandb logging, the different metrics, the save path, the physics and dataloaders,
and the pretrained checkpoint if given.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>train</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – whether model is being trained.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepinv.Trainer.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress_bar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_ite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_progress_bar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/deepinv/training/trainer.html#Trainer.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepinv.Trainer.step" title="Link to this definition">#</a></dt>
<dd><p>Train/Eval a batch.</p>
<p>It performs the forward pass, the backward pass, and the evaluation at each iteration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epoch</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Current epoch.</p></li>
<li><p><strong>progress_bar</strong> – <a class="reference external" href="https://tqdm.github.io/docs/tqdm/">tqdm</a> progress bar.</p></li>
<li><p><strong>train_ite</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – train iteration, only needed for logging if <code class="docutils literal notranslate"><span class="pre">Trainer.log_train_batch=True</span></code></p></li>
<li><p><strong>train</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the model is trained, otherwise it is evaluated.</p></li>
<li><p><strong>last_batch</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the last batch of the epoch is being processed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The current physics operator, the ground truth, the measurement, and the network reconstruction.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepinv.Trainer.stop_criterion">
<span class="sig-name descname"><span class="pre">stop_criterion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_ite</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/deepinv/training/trainer.html#Trainer.stop_criterion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepinv.Trainer.stop_criterion" title="Link to this definition">#</a></dt>
<dd><p>Stop criterion for early stopping.</p>
<p>By default, stops optimization when first eval metric doesn’t improve in the last 3 evaluations.</p>
<p>If <code class="code docutils literal notranslate"><span class="pre">early_stop_on_losses=True</span></code> (default is <code class="code docutils literal notranslate"><span class="pre">False</span></code>)
uses the first loss on the eval dataset instead (requires having <code class="code docutils literal notranslate"><span class="pre">compute_eval_losses=True</span></code>).</p>
<p>Override this method to early stop on a custom condition.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epoch</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Current epoch.</p></li>
<li><p><strong>train_ite</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Current training batch iteration, equal to (current epoch <span class="math notranslate nohighlight">\(\times\)</span> number
of batches) + current batch within epoch</p></li>
<li><p><strong>metric_history</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – Dictionary containing the metrics history, with the metric name as key.</p></li>
<li><p><strong>metrics</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – List of metrics used for evaluation.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepinv.Trainer.test">
<span class="sig-name descname"><span class="pre">test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test_dataloader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compare_no_learning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_raw_metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/deepinv/training/trainer.html#Trainer.test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepinv.Trainer.test" title="Link to this definition">#</a></dt>
<dd><p>Test the model, compute metrics and plot images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>test_dataloader</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader" title="(in PyTorch v2.9)"><em>torch.utils.data.DataLoader</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader" title="(in PyTorch v2.9)"><em>torch.utils.data.DataLoader</em></a><em>]</em>) – Test data loader(s), see <a class="reference internal" href="../../user_guide/training/datasets.html#datasets"><span class="std std-ref">datasets user guide</span></a>
for how we expect data to be provided.</p></li>
<li><p><strong>save_path</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Directory in which to save the plotted images.</p></li>
<li><p><strong>compare_no_learning</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the linear reconstruction is compared to the network reconstruction.</p></li>
<li><p><strong>log_raw_metrics</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – if <code class="code docutils literal notranslate"><span class="pre">True</span></code>, also return non-aggregated metrics as a list.</p></li>
<li><p><strong>metrics</strong> (<a class="reference internal" href="deepinv.loss.metric.Metric.html#deepinv.loss.metric.Metric" title="deepinv.loss.metric.Metric"><em>Metric</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>[</em><a class="reference internal" href="deepinv.loss.metric.Metric.html#deepinv.loss.metric.Metric" title="deepinv.loss.metric.Metric"><em>Metric</em></a><em>]</em><em>, </em><em>None</em>) – Metric or list of metrics used for evaluation. If
<code class="docutils literal notranslate"><span class="pre">None</span></code>, uses the metrics provided during Trainer initialization.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dict of metrics results with means and stds.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepinv.Trainer.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/deepinv/training/trainer.html#Trainer.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepinv.Trainer.train" title="Link to this definition">#</a></dt>
<dd><p>Train the model.</p>
<p>It performs the training process, including the setup, the evaluation, the forward and backward passes,
and the visualization.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The trained model.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<section id="examples-using-trainer">
<span id="sphx-glr-backref-deepinv-trainer"></span><h2>Examples using <code class="docutils literal notranslate"><span class="pre">Trainer</span></code>:<a class="headerlink" href="#examples-using-trainer" title="Link to this heading">#</a></h2>
<div class="sphx-glr-thumbnails"><div class="sphx-glr-thumbcontainer" tooltip="This example shows you how to train various networks using adversarial training for deblurring problems. We demonstrate running training and inference using a conditional GAN (i.e. DeblurGAN), CSGM, AmbientGAN and UAIR implemented in the library, and how to simply train your own GAN by using deepinv.training.AdversarialTrainer. These examples can also be easily extended to train more complicated GANs such as CycleGAN."><img alt="" src="../../_images/sphx_glr_demo_gan_imaging_thumb.png" />
<p><a class="reference internal" href="../../auto_examples/adversarial-learning/demo_gan_imaging.html#sphx-glr-auto-examples-adversarial-learning-demo-gan-imaging-py"><span class="std std-ref">Imaging inverse problems with adversarial networks</span></a></p>
  <div class="sphx-glr-thumbnail-title">Imaging inverse problems with adversarial networks</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example shows how to use DeepInverse with your own dataset."><img alt="" src="../../_images/sphx_glr_demo_custom_dataset_thumb.png" />
<p><a class="reference internal" href="../../auto_examples/basics/demo_custom_dataset.html#sphx-glr-auto-examples-basics-demo-custom-dataset-py"><span class="std std-ref">Bring your own dataset</span></a></p>
  <div class="sphx-glr-thumbnail-title">Bring your own dataset</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example shows how to perform inference on and fine-tune the Reconstruct Anything Model (RAM) foundation model :footciteterris2025reconstruct to solve inverse problems."><img alt="" src="../../_images/sphx_glr_demo_foundation_model_thumb.png" />
<p><a class="reference internal" href="../../auto_examples/models/demo_foundation_model.html#sphx-glr-auto-examples-models-demo-foundation-model-py"><span class="std std-ref">Inference and fine-tune a foundation model</span></a></p>
  <div class="sphx-glr-thumbnail-title">Inference and fine-tune a foundation model</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example provides a very simple quick start introduction to training reconstruction networks with DeepInverse for solving imaging inverse problems."><img alt="" src="../../_images/sphx_glr_demo_training_thumb.png" />
<p><a class="reference internal" href="../../auto_examples/models/demo_training.html#sphx-glr-auto-examples-models-demo-training-py"><span class="std std-ref">Training a reconstruction model</span></a></p>
  <div class="sphx-glr-thumbnail-title">Training a reconstruction model</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="In this example we use patch priors for limited angle computed tomography. More precisely, we consider the inverse problem y = \mathrm{noisy}(Ax), where A is the discretized Radon transform with 100 equispace angles between 20 and 160 degrees. For the reconstruction, we minimize the variational problem"><img alt="" src="../../_images/sphx_glr_demo_patch_priors_CT_thumb.png" />
<p><a class="reference internal" href="../../auto_examples/optimization/demo_patch_priors_CT.html#sphx-glr-auto-examples-optimization-demo-patch-priors-ct-py"><span class="std std-ref">Patch priors for limited-angle computed tomography</span></a></p>
  <div class="sphx-glr-thumbnail-title">Patch priors for limited-angle computed tomography</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example presents the various datasets, forward physics and models available in DeepInverse for Magnetic Resonance Imaging (MRI) problems:"><img alt="" src="../../_images/sphx_glr_demo_mri_tour_thumb.png" />
<p><a class="reference internal" href="../../auto_examples/physics/demo_mri_tour.html#sphx-glr-auto-examples-physics-demo-mri-tour-py"><span class="std std-ref">Tour of MRI functionality in DeepInverse</span></a></p>
  <div class="sphx-glr-thumbnail-title">Tour of MRI functionality in DeepInverse</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="In this example we demonstrate remote sensing inverse problems for multispectral satellite imaging."><img alt="" src="../../_images/sphx_glr_demo_remote_sensing_thumb.png" />
<p><a class="reference internal" href="../../auto_examples/physics/demo_remote_sensing.html#sphx-glr-auto-examples-physics-demo-remote-sensing-py"><span class="std std-ref">Remote sensing with satellite images</span></a></p>
  <div class="sphx-glr-thumbnail-title">Remote sensing with satellite images</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="We demonstrate the self-supervised Artifact2Artifact loss for solving an undersampled sequential MRI reconstruction problem without ground truth."><img alt="" src="../../_images/sphx_glr_demo_artifact2artifact_thumb.png" />
<p><a class="reference internal" href="../../auto_examples/self-supervised-learning/demo_artifact2artifact.html#sphx-glr-auto-examples-self-supervised-learning-demo-artifact2artifact-py"><span class="std std-ref">Self-supervised MRI reconstruction with Artifact2Artifact</span></a></p>
  <div class="sphx-glr-thumbnail-title">Self-supervised MRI reconstruction with Artifact2Artifact</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example demonstrates various geometric image transformations implemented in deepinv that can be used in Equivariant Imaging (EI) for self-supervised learning:"><img alt="" src="../../_images/sphx_glr_demo_ei_transforms_thumb.png" />
<p><a class="reference internal" href="../../auto_examples/self-supervised-learning/demo_ei_transforms.html#sphx-glr-auto-examples-self-supervised-learning-demo-ei-transforms-py"><span class="std std-ref">Image transformations for Equivariant Imaging</span></a></p>
  <div class="sphx-glr-thumbnail-title">Image transformations for Equivariant Imaging</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example shows you how to train a reconstruction network for an MRI inverse problem on a fully self-supervised way, i.e., using measurement data only."><img alt="" src="../../_images/sphx_glr_demo_equivariant_imaging_thumb.png" />
<p><a class="reference internal" href="../../auto_examples/self-supervised-learning/demo_equivariant_imaging.html#sphx-glr-auto-examples-self-supervised-learning-demo-equivariant-imaging-py"><span class="std std-ref">Self-supervised learning with Equivariant Imaging for MRI.</span></a></p>
  <div class="sphx-glr-thumbnail-title">Self-supervised learning with Equivariant Imaging for MRI.</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example shows you how to train a reconstruction network for an inpainting inverse problem on a fully self-supervised way, i.e., using measurement data only."><img alt="" src="../../_images/sphx_glr_demo_multioperator_imaging_thumb.png" />
<p><a class="reference internal" href="../../auto_examples/self-supervised-learning/demo_multioperator_imaging.html#sphx-glr-auto-examples-self-supervised-learning-demo-multioperator-imaging-py"><span class="std std-ref">Self-supervised learning from incomplete measurements of multiple operators.</span></a></p>
  <div class="sphx-glr-thumbnail-title">Self-supervised learning from incomplete measurements of multiple operators.</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example shows you how to train a denoiser network in a fully self-supervised way, i.e., using noisy images only via the Neighbor2Neighbor loss, which exploits the local correlation of natural images."><img alt="" src="../../_images/sphx_glr_demo_n2n_denoising_thumb.png" />
<p><a class="reference internal" href="../../auto_examples/self-supervised-learning/demo_n2n_denoising.html#sphx-glr-auto-examples-self-supervised-learning-demo-n2n-denoising-py"><span class="std std-ref">Self-supervised denoising with the Neighbor2Neighbor loss.</span></a></p>
  <div class="sphx-glr-thumbnail-title">Self-supervised denoising with the Neighbor2Neighbor loss.</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example shows you how to train a denoiser network in a fully self-supervised way, using noisy images only via the Generalized Recorrupted2Recorrupted (GR2R) loss :footcitemonroy2025generalized, which exploits knowledge about the noise distribution. You can change the noise distribution by selecting from predefined noise models such as Gaussian, Poisson, and Gamma noise."><img alt="" src="../../_images/sphx_glr_demo_r2r_denoising_thumb.png" />
<p><a class="reference internal" href="../../auto_examples/self-supervised-learning/demo_r2r_denoising.html#sphx-glr-auto-examples-self-supervised-learning-demo-r2r-denoising-py"><span class="std std-ref">Self-supervised denoising with the Generalized R2R loss.</span></a></p>
  <div class="sphx-glr-thumbnail-title">Self-supervised denoising with the Generalized R2R loss.</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="We demonstrate self-supervised learning with measurement splitting, to train a denoiser network on the MNIST dataset. The physics here is noisy computed tomography, as is the case in Noise2Inverse :footcitehendriksen2020noise2inverse. Note this example can also be easily applied to undersampled multicoil MRI as is the case in SSDU :footciteyaman2020self."><img alt="" src="../../_images/sphx_glr_demo_splitting_loss_thumb.png" />
<p><a class="reference internal" href="../../auto_examples/self-supervised-learning/demo_splitting_loss.html#sphx-glr-auto-examples-self-supervised-learning-demo-splitting-loss-py"><span class="std std-ref">Self-supervised learning with measurement splitting</span></a></p>
  <div class="sphx-glr-thumbnail-title">Self-supervised learning with measurement splitting</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example shows you how to train a denoiser network in a fully self-supervised way, i.e., using noisy images only via the SURE loss, which exploits knowledge about the noise distribution."><img alt="" src="../../_images/sphx_glr_demo_sure_denoising_thumb.png" />
<p><a class="reference internal" href="../../auto_examples/self-supervised-learning/demo_sure_denoising.html#sphx-glr-auto-examples-self-supervised-learning-demo-sure-denoising-py"><span class="std std-ref">Self-supervised denoising with the SURE loss.</span></a></p>
  <div class="sphx-glr-thumbnail-title">Self-supervised denoising with the SURE loss.</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example shows you how to train a denoiser network in a fully self-supervised way, i.e., using noisy images with unknown noise level only via the UNSURE loss, which is introduced by :footcitetachella2024unsure."><img alt="" src="../../_images/sphx_glr_demo_unsure_thumb.png" />
<p><a class="reference internal" href="../../auto_examples/self-supervised-learning/demo_unsure.html#sphx-glr-auto-examples-self-supervised-learning-demo-unsure-py"><span class="std std-ref">Self-supervised denoising with the UNSURE loss.</span></a></p>
  <div class="sphx-glr-thumbnail-title">Self-supervised denoising with the UNSURE loss.</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This a toy example to show you how to use DEQ to solve a deblurring problem. Note that this is a small dataset for training. For optimal results, use a larger dataset."><img alt="" src="../../_images/sphx_glr_demo_DEQ_thumb.png" />
<p><a class="reference internal" href="../../auto_examples/unfolded/demo_DEQ.html#sphx-glr-auto-examples-unfolded-demo-deq-py"><span class="std std-ref">Deep Equilibrium (DEQ) algorithms for image deblurring</span></a></p>
  <div class="sphx-glr-thumbnail-title">Deep Equilibrium (DEQ) algorithms for image deblurring</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example shows how to implement the LISTA algorithm :footcitegregor2010learning, for a compressed sensing problem. In a nutshell, LISTA is an unfolded proximal gradient algorithm involving a soft-thresholding proximal operator with learnable thresholding parameters."><img alt="" src="../../_images/sphx_glr_demo_LISTA_thumb.png" />
<p><a class="reference internal" href="../../auto_examples/unfolded/demo_LISTA.html#sphx-glr-auto-examples-unfolded-demo-lista-py"><span class="std std-ref">Learned Iterative Soft-Thresholding Algorithm (LISTA) for compressed sensing</span></a></p>
  <div class="sphx-glr-thumbnail-title">Learned Iterative Soft-Thresholding Algorithm (LISTA) for compressed sensing</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example shows how to implement a learned unrolled proximal gradient descent algorithm with a custom prior function. The algorithm is trained on a dataset of compressed sensing measurements of MNIST images."><img alt="" src="../../_images/sphx_glr_demo_custom_prior_unfolded_thumb.png" />
<p><a class="reference internal" href="../../auto_examples/unfolded/demo_custom_prior_unfolded.html#sphx-glr-auto-examples-unfolded-demo-custom-prior-unfolded-py"><span class="std std-ref">Learned iterative custom prior</span></a></p>
  <div class="sphx-glr-thumbnail-title">Learned iterative custom prior</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="where both the data fidelity and the prior are learned modules, distinct for each iterations."><img alt="" src="../../_images/sphx_glr_demo_learned_primal_dual_thumb.png" />
<p><a class="reference internal" href="../../auto_examples/unfolded/demo_learned_primal_dual.html#sphx-glr-auto-examples-unfolded-demo-learned-primal-dual-py"><span class="std std-ref">Learned Primal-Dual algorithm for CT scan.</span></a></p>
  <div class="sphx-glr-thumbnail-title">Learned Primal-Dual algorithm for CT scan.</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="Some unfolded architectures rely on a least-squares solver &lt;deepinv.optim.utils.least_squares&gt; to compute the proximal step w.r.t. the data-fidelity term (e.g., deepinv.optim.optim_iterators.ADMMIteration or deepinv.optim.optim_iterators.HQSIteration):  "><img alt="" src="../../_images/sphx_glr_demo_unfolded_constant_memory_thumb.png" />
<p><a class="reference internal" href="../../auto_examples/unfolded/demo_unfolded_constant_memory.html#sphx-glr-auto-examples-unfolded-demo-unfolded-constant-memory-py"><span class="std std-ref">Reducing the memory and computational complexity of unfolded network training</span></a></p>
  <div class="sphx-glr-thumbnail-title">Reducing the memory and computational complexity of unfolded network training</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="Image inpainting consists in solving y = Ax where A is a mask operator. This problem can be reformulated as the following minimization problem:"><img alt="" src="../../_images/sphx_glr_demo_unfolded_constrained_LISTA_thumb.png" />
<p><a class="reference internal" href="../../auto_examples/unfolded/demo_unfolded_constrained_LISTA.html#sphx-glr-auto-examples-unfolded-demo-unfolded-constrained-lista-py"><span class="std std-ref">Unfolded Chambolle-Pock for constrained image inpainting</span></a></p>
  <div class="sphx-glr-thumbnail-title">Unfolded Chambolle-Pock for constrained image inpainting</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This is a simple example to show how to use vanilla unfolded Plug-and-Play. The DnCNN denoiser and the algorithm parameters (stepsize, regularization parameters) are trained jointly. For simplicity, we show how to train the algorithm on a  small dataset. For optimal results, use a larger dataset."><img alt="" src="../../_images/sphx_glr_demo_vanilla_unfolded_thumb.png" />
<p><a class="reference internal" href="../../auto_examples/unfolded/demo_vanilla_unfolded.html#sphx-glr-auto-examples-unfolded-demo-vanilla-unfolded-py"><span class="std std-ref">Vanilla Unfolded algorithm for super-resolution</span></a></p>
  <div class="sphx-glr-thumbnail-title">Vanilla Unfolded algorithm for super-resolution</div>
</div></div></section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../deepinv.training.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">deepinv.training</p>
      </div>
    </a>
    <a class="right-next"
       href="deepinv.train.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">train</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deepinv.Trainer"><code class="docutils literal notranslate"><span class="pre">Trainer</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deepinv.Trainer.check_clip_grad"><code class="docutils literal notranslate"><span class="pre">Trainer.check_clip_grad()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deepinv.Trainer.compute_loss"><code class="docutils literal notranslate"><span class="pre">Trainer.compute_loss()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deepinv.Trainer.compute_metrics"><code class="docutils literal notranslate"><span class="pre">Trainer.compute_metrics()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deepinv.Trainer.get_samples"><code class="docutils literal notranslate"><span class="pre">Trainer.get_samples()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deepinv.Trainer.get_samples_offline"><code class="docutils literal notranslate"><span class="pre">Trainer.get_samples_offline()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deepinv.Trainer.get_samples_online"><code class="docutils literal notranslate"><span class="pre">Trainer.get_samples_online()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deepinv.Trainer.load_best_model"><code class="docutils literal notranslate"><span class="pre">Trainer.load_best_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deepinv.Trainer.load_model"><code class="docutils literal notranslate"><span class="pre">Trainer.load_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deepinv.Trainer.log_metrics_mlops"><code class="docutils literal notranslate"><span class="pre">Trainer.log_metrics_mlops()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deepinv.Trainer.log_metrics_wandb"><code class="docutils literal notranslate"><span class="pre">Trainer.log_metrics_wandb()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deepinv.Trainer.model_inference"><code class="docutils literal notranslate"><span class="pre">Trainer.model_inference()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deepinv.Trainer.no_learning_inference"><code class="docutils literal notranslate"><span class="pre">Trainer.no_learning_inference()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deepinv.Trainer.plot"><code class="docutils literal notranslate"><span class="pre">Trainer.plot()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deepinv.Trainer.reset_metrics"><code class="docutils literal notranslate"><span class="pre">Trainer.reset_metrics()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deepinv.Trainer.save_best_model"><code class="docutils literal notranslate"><span class="pre">Trainer.save_best_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deepinv.Trainer.save_model"><code class="docutils literal notranslate"><span class="pre">Trainer.save_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deepinv.Trainer.setup_train"><code class="docutils literal notranslate"><span class="pre">Trainer.setup_train()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deepinv.Trainer.step"><code class="docutils literal notranslate"><span class="pre">Trainer.step()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deepinv.Trainer.stop_criterion"><code class="docutils literal notranslate"><span class="pre">Trainer.stop_criterion()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deepinv.Trainer.test"><code class="docutils literal notranslate"><span class="pre">Trainer.test()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deepinv.Trainer.train"><code class="docutils literal notranslate"><span class="pre">Trainer.train()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#examples-using-trainer">Examples using <code class="docutils literal notranslate"><span class="pre">Trainer</span></code>:</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/api/stubs/deepinv.Trainer.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright deepinverse contributors 2025.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>