{#
 Custom launcher links for Sphinx-Gallery example pages.
 This adds an "Open in Colab" button that opens the notebook version
 of the current example.

 Assumptions:
 - The docs site is published from the gh-pages branch and includes .ipynb
   files generated by Sphinx-Gallery under auto_examples/...
 - This template is referenced by the theme via html_theme_options secondary_sidebar_items
   as "sg_launcher_links".
#}

{% if pagename.startswith('auto_examples/') %}
{#
  Derive the source .py path from the example page path.
  Gallery pages live at auto_examples/<section>/<name> and source scripts at examples/<section>/<name>.py
#}
{% set example_py_path = pagename.replace('auto_examples/', 'examples/') + '.py' %}
{% set example_ipynb_repo_path = example_py_path.replace('examples/', 'examples/_notebooks/').replace('.py', '.ipynb') %}

<div class="sd-card sd-shadow-sm sd-mb-3">
  <div class="sd-card-body">
    <p class="sd-card-text sd-fs-5 sd-font-weight-bold sd-mb-2">Run this example</p>

    {# Primary: open the source .py on Colab (Colab can render scripts; install instructions are in first cell) #}
    <a class="sd-btn sd-btn-primary sd-mr-2" href="https://colab.research.google.com/github/{{ repo_owner }}/{{ repo_name }}/blob/{{ repo_source_ref }}/{{ example_ipynb_repo_path }}" target="_blank" rel="noopener">
      <img alt="Open in Colab" src="https://colab.research.google.com/assets/colab-badge.svg" style="vertical-align: middle; height: 20px;"> Try it!
    </a>

  </div>
</div>
{% endif %}
